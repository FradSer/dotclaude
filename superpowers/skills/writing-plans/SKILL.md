---
name: writing-plans
description: This skill should be used when the user has a design (from brainstorming) and needs to break it down into a detailed, step-by-step implementation plan with verification steps for each task.
argument-hint: [design-folder-path]
user-invocable: true
version: 1.3.0
---

# Writing Plans

Create executable implementation plans that reduce ambiguity for whoever executes them.

## Initialization

1. **Resolve Design Path**:
   - If `$ARGUMENTS` provides a path (e.g., `docs/plans/YYYY-MM-DD-topic-design/`), use it as the design source.
   - If no argument is provided:
     - Search `docs/plans/` for the most recent `*-design/` folder matching the pattern `YYYY-MM-DD-*-design/`
     - If found, confirm with user: "Use this design: [path]?"
     - If not found or user declines, ask the user for the design folder path.
2. **Design Check**: Verify the folder contains `_index.md` and `bdd-specs.md`.
3. **Context**: Read `bdd-specs.md` completely. This is the source of truth for your tasks.

## Background Knowledge

**Core Concept**: Explicit over implicit, granular tasks, verification-driven, context independence. **PROHIBITED**: Do not generate actual code - focus on what to do, not implementation details.

- **MANDATORY**: Tasks must be driven by BDD scenarios (Given/When/Then).
- **MANDATORY**: Test-First (Red-Green) workflow. Verification tasks must precede implementation tasks.
- **MANDATORY**: When plans include unit tests, require external dependency isolation with test doubles (DB/network/third-party APIs).
- **PROHIBITED**: Do not generate actual code - describe what to implement, not the implementation itself.
- **MANDATORY**: One task per file. Each task gets its own `.md` file.
- **MANDATORY**: _index.md contains overview and references to all task files.

## Phase 1: Plan Structure

Define goal, architecture, constraints.

1. **Read Specs**: Read `bdd-specs.md` from the design folder (generated by `brainstorming`).
2. **Draft Structure**: Use `./references/plan-structure-template.md` to outline the plan.

## Phase 2: Task Decomposition

Break into small tasks mapped to specific BDD scenarios.

1. **Reference Scenarios**: **CRITICAL**: Every task must explicitly reference a BDD Scenario (e.g., "Implement Login (ref: Scenario 1)").
2. **Define Verification**: **CRITICAL**: Verification steps must run the BDD specs (e.g., `npm test tests/login.spec.ts`).
3. **Enforce Ordering**: Task N (Test/Red) -> Task N+1 (Implementation/Green).
4. **Ensure Compatibility**: Ensure tasks are compatible with `superpowers:behavior-driven-development`.
5. **Create Task Files**: **MANDATORY**: Create one `.md` file per task. Filename pattern: `task-<NNN>-<short-description>.md`.
6. **Describe What, Not How**: **PROHIBITED**: Do not generate actual code. Describe what to implement (e.g., "Create a function that validates user credentials"), not the implementation (e.g., "def validate_credentials(username, password): ...").

## Phase 3: Validation & Documentation

Verify completeness, confirm with user, and save.

1. **Verify**: Check for valid commit boundaries and no vague tasks.
2. **Confirm**: Get user approval on the plan.
3. **Save**: Write to `docs/plans/YYYY-MM-DD-<topic>-plan/` folder.
   - **CRITICAL**: `_index.md` MUST include "Execution Plan" section with references to all task files
   - Example: `- [Task 001: Setup](./task-001-setup.md)`

## Git Commit

Commit the plan folder to git with proper message format.

**Commit**:
```bash
git add docs/plans/YYYY-MM-DD-<topic>-plan/
git commit -m "docs: add implementation plan for <topic>

<Context>

- <Specific action taken>
- <Specific action taken>

<Summary>

Co-Authored-By: <Model Name> <noreply@anthropic.com>"
```

**Requirements**:
- Prefix: `docs:` (lowercase)
- Subject: Under 50 characters, lowercase
- Body: Context, specific actions, plan summary
- Footer: Co-Authored-By with model name

**Verify**: Run `git log -1` to confirm commit.

See `./references/git-commit.md` for detailed patterns and requirements.

## Phase 4: Transition to Execution

**Goal**: Seamlessly transition to executing the plan.

**Actions**:

1. **Invoke `superpowers:executing-plans`** using the Skill tool, passing the plan folder path as an argument.

## Exit Criteria

Plan created with clear goal/constraints, decomposed tasks with file lists and verification, BDD steps, commit boundaries, no vague tasks, user approval.

## References

- `./references/plan-structure-template.md` - Template for plan structure
- `./references/task-granularity-and-verification.md` - Guide for task breakdown and verification
- `./references/git-commit.md` - Git commit patterns and requirements
